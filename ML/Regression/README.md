# π¦ TIL


## β… Regression

### - μ¤μ°¨ μΈ΅μ • λ°©λ²•

#### MAE(Mean Absolute Error)
* μμΈ΅κ°’κ³Ό μ‹¤μ κ°’μ μ°¨μ΄μ— λ€ν• μ λ“κ°’μ ν‰κ· 
* λ€νμ—μ„ μ‚¬μ©ν•λ” κ²½μ°λ” λ§μ§€ μ•μ, μ•„λ λ°©λ²•λ“¤μ„ μ΄ν•΄ν•κΈ° μ„ν•¨

#### MAPE(Mean Absolute Percentage Error)
* (μ‹¤μ κ°’ - μμΈ΅κ°’ / μ‹¤μ κ°’)μ μ λ“κ°’μ— λ€ν• ν‰κ· 
* 0μ— κ°€κΉμΈμλ΅ μΆ‹μ€ κ°’

#### MSE(Mean Squared Error)
* μ‹¤μ κ°’ - μμΈ΅κ°’μ μ°¨μ΄μ μ κ³±μ ν‰κ· 
* MAEμ™€ λΉ„μ·ν•΄ λ³΄μ΄λ‚ μ κ³±μ„ ν†µν•΄ μμλ¥Ό μ–‘μλ΅ λ³€ν™
* λ¶„μ‚°κ³Ό μ μ‚¬ν• κ³µμ‹
  * λ¶„μ‚° : ν‰κ· μΌλ΅λ¶€ν„° μ–Όλ§λ‚ λ–¨μ–΄μ Έ μλ”μ§€ ν™•μΈ
  * MSE : μ‹¤μ κ°’μΌλ΅λ¶€ν„° μ–Όλ§λ‚ λ–¨μ–΄μ Έ μλ”μ§€ ν™•μΈ

#### RMSE(Root Mean Squared Error)
* MSEμ μ κ³±κ·Ό
* ν‘μ¤€νΈμ°¨μ™€ μ μ‚¬ν• κ³µμ‹

> μƒν™©μ— λ”°λΌ μ–΄λ–¤ λ°©λ²•μ΄ μΆ‹μ„μ§€ νλ‹¨ν•΄μ•Ό ν•¨
> * A : 100μ–µ λ¶€λ™μ‚° 110μ–µμΌλ΅ μμΈ΅
> * B : 1μ–µ λ¶€λ™μ‚° 2μ–µμΌλ΅ μμΈ΅
> * MAEλ΅ ν‰κ°€ν•λ©΄ Bκ°€ λ” μ μμΈ΅
> * MAPEλ΅ ν‰κ°€ν•λ©΄ Aκ°€ λ” μ μμΈ΅ <br>
> MSEκ°€ μ λ“κ°’μ— λΉ„ν•΄ μ¤μ°¨κ°€ λ” ν° κ°’μ— λ€ν•΄ ν¨λ„ν‹°λ¥Ό λ” λ§μ΄ μ¤„ μλ” μμ§€λ§ μμΈ΅ λΉ„μ¨μ— λ€ν•΄μ„λ” νμ•…ν•  μ μ—†μ

<br>

### - train_test_split
* `stratify`
  * `train set`κ³Ό `test set`λ¥Ό λ¶„λ¦¬ν•  λ•, `class` λΉ„μ¨μ„ λ™μΌν•κ² ν•λ” κ²ƒ
```python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y, random_state=42)
```


<br>

### - plt.subplots()
* μ—¬λ¬ κ·Έλν”„λ¥Ό ν• κ³³μ— κ·Έλ¦¬κΈ°
```python
plt.subplots(nrows=2, ncols=4, figsize=(12, 7))
# μ¶λ ¥λ¬Όμ΄ μ•„λμ™€ κ°™μ, tuple ν•νƒ
# (<Figure size 1200x700 with 8 Axes>,
#  array([[<AxesSubplot:>, <AxesSubplot:>, <AxesSubplot:>, <AxesSubplot:>],
#         [<AxesSubplot:>, <AxesSubplot:>, <AxesSubplot:>, <AxesSubplot:>]],
#        dtype=object))

# figure sizeλ¥Ό fig
# arrayλ¥Ό axesμ— μ§€μ •
fig, axes = plt.subplots(nrows=2, ncols=4, figsize=(12, 7))

# νλΌλ―Έν„° axλ¥Ό μ΄μ©ν•μ—¬ subplotμ μ„μΉ μ§€μ •
# set_title : title of subplot
sns.countplot(data=df, x=y_train, ax=axes[0, 1]).set_title("train")
sns.countplot(data=df, x=y_test, ax=axes[1, 3]).set_title("test")
```

<br>

## β… hyper parameter tuning
* ν•μ΄νΌ νλΌλ―Έν„° μµμ ν™”
  * μ•κ³ λ¦¬μ¦μ ν•μ΄νΌ νλΌλ―Έν„° κ°’μ„ μ§€μ •ν•κ³  μ§€μ • λ κ°’ μ¤‘ μΆ‹μ€ μ„±λ¥μ„ λ‚΄λ” νλΌλ―Έν„°λ¥Ό μ°Ύλ” κ³Όμ •
* `GridSearchCV`
  * [GridSearchCV κ³µμ‹ λ¬Έμ„](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV) 
  * μ§€μ • λ κµ¬κ°„μ— λ€ν• κ°’μ— λ€ν•΄μ„ νƒμƒ‰
  * μ΅°ν•©μ μ λ§νΌ μ‹¤ν–‰
* `RandomizedSearchCV`
  * [RandomizedSearchCV κ³µμ‹ λ¬Έμ„](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html#sklearn.model_selection.RandomizedSearchCV) 
  * μ§€μ • λ κµ¬κ°„ μ™Έμ— μµμ  κ°’μ΄ μμ„ λ• κ·Έλ¦¬λ“ μ„μΉλ΅ μ°Ύμ§€ λ»ν•λ” λ‹¨μ μ„ λ³΄μ™„
  * λλ¤ν• κ°’λ“¤μ„ μ§€μ •ν•μ—¬ μ„±λ¥μ„ ν‰κ°€ν•κ³  κ°€μ¥ μΆ‹μ€ μ„±λ¥μ„ λ‚΄λ” νλΌλ―Έν„°λ¥Ό μ°Ύμ
  * μΆ‹μ€ μ„±λ¥μ„ λ‚΄λ” κµ¬κ°„μΌλ΅ μ μ  μΆν€κ°€λ©° νλΌλ―Έν„° νƒμƒ‰
  * `k-fold` * `n_iter` λ§νΌ μ‹¤ν–‰

|  -  |                               GridSearchCV                               |                                 RandomizedSearchCV                                 |
|:---:|:------------------------------------------------------------------------:|:----------------------------------------------------------------------------------:| 
| μ •μ  |                ν•μ΄νΌ νλΌλ―Έν„° ν›„λ³΄κµ° λ“¤μ„ <br/> μ™„μ „ νƒμƒ‰ν•μ—¬ ν•μ΄νΌ νλΌλ―Έν„°λ¥Ό κ²€μƒ‰                |   μ •ν•΄μ§„ νμ μ•μ—μ„ μ •μλ ν•μ΄νΌ νλΌλ―Έν„°<br/>ν›„λ³΄κµ°λ“¤λ΅λ¶€ν„°μ μ΅°ν•©μ„ λλ¤ν•κ² μƒν”λ§ν•μ—¬<br/>μµμ†μ μ¤μ°¨λ¥Ό κ°–λ” ν•μ΄νΌ νλΌλ―Έν„° κ²€μƒ‰   |
| μ¥μ   | κ²€μ¦ν•κ³  μ‹¶μ€ ν•μ΄νΌ νλΌλ―Έν„° μμΉλ¥Ό<br/> μ§€μ •ν•λ©΄ μμΉλ³„ μ΅°ν•©μ„ λ¨λ‘ κ²€μ¦ν•μ—¬ <br/> μµμ μ νλΌλ―Έν„° κ²€μƒ‰μ μ •ν™•λ„ ν–¥μƒ |                λ¬΄μ‘μ„λ΅ κ°’μ„ μ„ μ •ν•κ³  κ·Έ μ΅°ν•©μ„ κ²€μ¦ν•λ―€λ΅<br/>λΉ λ¥Έ μ†λ„λ΅ μµμ μ νλΌλ―Έν„° μ΅°ν•©μ„ κ²€μƒ‰                 |
| λ‹¨μ   |    ν›„λ³΄κµ°μ κ°μκ°€ λ§μΌλ©΄ λ§μ„μλ΅ <br/> κΈ°ν•κΈ‰μμ μΌλ΅ μ°Ύλ” μ‹κ°„μ€ μ¤λ κ±Έλ¦¬λ©° <br/>ν›„λ³΄κµ°λ“¤μ„ μ •ν™•ν μ„¤μ • ν•„μ” <br/> μ§€μ •λ μ΅°ν•©λ§ λ³΄κΈ° λ•λ¬Έμ— ν•΄λ‹Ή κ·Έλ¦¬λ“λ¥Ό <br/> λ²—μ–΄λ‚λ” κ³³μ— μµμ μ ν•μ΄νΌ νλΌλ―Έν„°κ°€ <br/> μλ‹¤λ©΄ μ°Ύμ§€ λ»ν•¨  | ν›„λ³΄κµ°μ„ μ‹ μ¤‘ν κ²°μ •ν•΄μ•Όν•λ©°, λλ¤ν• μ΅°ν•©λ“¤ μ¤‘ <br/>μµμ μ ν•μ΄νΌ νλΌλ―Έν„°λ¥Ό μ°Ύλ”λ‹¤λ” λ³΄μ¥μ΄ μ—†μ<br/>νμλ¥Ό λλ ¤μ£Όλ©΄ μ‹κ°„λ„ λΉ„λ΅€ν•μ—¬ μ¦κ°€ |

